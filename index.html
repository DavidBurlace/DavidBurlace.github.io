<!DOCTYPE html>
<html>
  <head>
    <title>Wellington Bike Stands</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />

    <style>
      html, body {
        height: 100%;
        margin: 0;
      }
      #map {
        width: 600px;
        height: 400px;
      }
    </style>
    <style>body { padding: 0; margin: 0; } #map { height: 100%; width: 100vw; }</style>
  </head>
  <body>
    <div id="map"></div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js"></script>
    <script src="https://unpkg.com/esri-leaflet@2.3.2/dist/esri-leaflet.js"></script>
    <script>
      var pointsToCheck = [
{ "type": "Feature", "properties": { "Asset_Desc": "Two bike racks South Eastern corner of the artificial turf. Adjacent to the warm up area.", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.774193859871957, -41.326792130937172 ], [ 174.774269607290222, -41.326758313788922 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Steel pipe bike stands near Davies St entrance, next to scooter rack.", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.828843599624633, -41.164208972758153 ], [ 174.828834699723075, -41.164206492970202 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Tilley scooter park, attached to the back of the wall with Grasslees signage on it, Davies St entrance.", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.828853174981475, -41.164213110881164 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Under cliffs south of boardwalk from Steeple Lane", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.838598130246936, -41.326162842362116 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MCMILLAN CT", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.822748110581387, -41.222816547382308 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MCMILLAN CT", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.822755419064521, -41.222822483652642 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MCMILLAN CT", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.82294820520238, -41.222750195549331 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand RONGOTAI RD-SOUTH", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.800231760402283, -41.318903928422266 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand RONGOTAI RD-SOUTH", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.800813728246624, -41.319089311034155 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB52 - Courtenay Park bike post RONGOTAI RD-SOUTH", "Model_of_C": "FB52 - Courtenay Park bike post", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.800256426137253, -41.318759971089733 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB54 - Johnsonville bike stand ALLINGTON RD", "Model_of_C": "FB54 - Johnsonville bike stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.721379467638883, -41.289642672298484 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand KARORI RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.750242680659255, -41.281474454349414 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand KARORI RECREATION CENTRE", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.737874653466378, -41.284980805974115 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand KARORI RECREATION CENTRE", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.73787970523216, -41.284996261789168 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand KARORI RECREATION CENTRE", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.737888002450063, -41.285017019802218 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand KARORI RECREATION CENTRE", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.737903845128415, -41.285053381521514 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand KARORI RECREATION CENTRE", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.737897089842761, -41.285033985540487 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand 53 OTTAWA RD", "Model_of_C": "FB51 - Bike Stand", "Comments": "Metal tube,"  }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.77448728137631, -41.248381981884869 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand BOSCOBEL LANE", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.827223009076249, -41.184549843770391 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand WILLOWBANK RESERVE AND PLAY AREA", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.827266964818875, -41.184530320856702 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand ADELAIDE RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.775210096976195, -41.320055369885395 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand ADELAIDE RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.775210096976195, -41.320055369885395 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand COUTTS ST", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.80564309191351, -41.32437328178797 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand TACY ST", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.799977974986092, -41.315829699791138 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand TACY ST", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.799966650605256, -41.315827660268496 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand TACY ST", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.79999950777659, -41.315834207917234 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand BRACKEN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.823514288843484, -41.223106601196534 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand BRACKEN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.823521485788859, -41.223122258040064 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand BRACKEN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.823525618021364, -41.223136415078791 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand CHELSEA ST", "Model_of_C": "FB51 - Bike Stand", "Comments": "INstalled in concrete pad", }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.817356642806686, -41.318080834739263 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand CHELSEA ST", "Model_of_C": "FB51 - Bike Stand", "Comments": "INstalled in concrete pad", }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.817344573029914, -41.318085367712968 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand CHELSEA ST", "Model_of_C": "FB51 - Bike Stand", "Comments": "INstalled in concrete pad", }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.817369383015716, -41.318074287985276 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MAIN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.825086285549759, -41.170230686920206 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MAIN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.825072359895159, -41.170225864429668 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MAIN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.825076814725094, -41.170228105106141 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "FB51 - Bike Stand MAIN RD", "Model_of_C": "FB51 - Bike Stand", "Comments": null, }, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.825081130777704, -41.170229340059187 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Cycle rack at the southern end of the play area, beside the drinking fountain. Wakefield Park and Play Area", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.774796663551342, -41.327157285110744 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Cycle rack at the northern end of the play area, beside the entrance. Wakefield Park and Play Area", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.774782302977343, -41.326780242395728 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Scooter park at the northern end of the play area, beside the entrance and skate park. Wakefield Park and Play Area", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.774855924188103, -41.326831989700501 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Cycle racks to the northern of the shelter across from Tug Wharf.", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.779066240425266, -41.282458519252145 ], [ 174.779076269114086, -41.282462110330016 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Cycle racks located at the Happy Valley Road entrance to Te Kopahou.", "Model_of_C": "Not Applicable", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.757008195952864, -41.331738193279875 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Wellington Waterfront Clyde Quay Wharf Public Space 1 Bar Bike Rack top end of the wharf.", "Model_of_C": "FB51 - Bike Stand", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.785800915139816, -41.288405147577357 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Wellington Waterfront Rowing Club Public Space 4 Bar Bike Rack back of Wharewaka Building.", "Model_of_C": "FB51 - Bike Stand", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.779828638218845, -41.288462385787213 ], [ 174.779836724230904, -41.288462260733709 ], [ 174.779845828237256, -41.288460794073522 ], [ 174.779854608914547, -41.288460392562477 ] ] } },
{ "type": "Feature", "properties": { "Asset_Desc": "Wellington Waterfront Kumutoto Plaza & Laneway 2 Bar Bike Rack just outside entrance to Meridian Energy building.", "Model_of_C": "FB51 - Bike Stand", "Comments": null}, "geometry": { "type": "MultiPoint", "coordinates": [ [ 174.77889786922114, -41.283146950017674 ], [ 174.778901555917486, -41.283141343681422 ] ] } }]
    </script>

    <script>   
      var map = L.map('map', {
        minZoom: 2, 
        maxZoom: 20
      });

      var bikestands = L.esri.featureLayer({
        url: 'https://gisdev.wcc.govt.nz/arcgis/rest/services/Asset/WCC_Assets/MapServer/10',
        pointToLayer: function (geojson, latlng) {
          return L.circleMarker(latlng);
            },
            style: {
              color: 'green',
              weight: 2,
              opacity: 0.85,
              fillOpacity: 0.0
            },
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<br><strong>Model of Cycle Rack: </strong>" + feature.properties.Model_of_Cycle_Rack +
            "<br><strong>Asset Description: </strong>" + feature.properties.Asset_Description +
            "<br><strong>Comment:</strong> " + feature.properties.Comment)
            },
        where: "Model_of_Cycle_Rack <> 'FB56 - Cyclehoop'" 
      }).addTo(map);

      var bikehoops = L.esri.featureLayer({
        url: 'https://gisdev.wcc.govt.nz/arcgis/rest/services/Asset/WCC_Assets/MapServer/10',
        pointToLayer: function (geojson, latlng) {
          return L.circleMarker(latlng);
            },
            style: {
              color: 'yellow',
              weight: 2,
              opacity: 0.85,
              fillOpacity: 0.0
            },
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<br><strong>Model of Cycle Rack: </strong>" + feature.properties.Model_of_Cycle_Rack +
            "<br><strong>Asset Description: </strong>" + feature.properties.Asset_Description +
            "<br><strong>Comment:</strong> " + feature.properties.Comment)
            },
        where: "Model_of_Cycle_Rack = 'FB56 - Cyclehoop'" 
      });

      var bikemaintenance = L.esri.featureLayer({
        url: 'https://gisdev.wcc.govt.nz/arcgis/rest/services/Asset/WCC_Assets/MapServer/3',
        pointToLayer: function (geojson, latlng) {
          return L.circleMarker(latlng);
            },
            style: {
              color: 'black',
              weight: 2,
              opacity: 0.85,
              fillOpacity: 0.0
            },
        onEachFeature: function (feature, layer) {
          layer.bindPopup("<br><strong>Model of Cycle Rack: </strong>" + feature.properties.Model_of_Cycle_Rack +
            "<br><strong>Asset Description: </strong>" + feature.properties.Asset_Description +
            "<br><strong>Comment:</strong> " + feature.properties.Comment)
            } 
      });

      var geojsonMarkerOptions = {
          radius: 12,
          color: "#ff7800",
          weight: 4,
          opacity: 1,
          fillOpacity: 0.0
      };

      var toCheck = L.geoJSON(pointsToCheck, {
        pointToLayer: function (feature, latlng) {
          return L.circleMarker(latlng, geojsonMarkerOptions);
            },
          onEachFeature: function (feature, layer) {
            layer.bindPopup("<br><strong>Model of Cycle Rack: </strong>" + feature.properties.Model_of_C +
              "<br><strong>Asset Description: </strong>" + feature.properties.Asset_Desc +
              "<br><strong>Comment:</strong> " + feature.properties.Comments)
              } 
      }).addTo(map);

      var cycleways  = L.esri.featureLayer({
        url: 'https://gisdev.wcc.govt.nz/arcgis/rest/services/Asset/WCC_Assets/MapServer/29'
      }).setStyle({color:'red', fill:false, weight: 2
      });

      // Basemaps
      var cyclosm = L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {
          maxZoom: 20,
          attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      });

      var Esri_WorldImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
        zIndex: 2
      });

      // Layer control
      var baseLayers = {
        "Cyclosm": cyclosm,
        "Satellite": Esri_WorldImagery
      };
      
      var overlayMaps = {
        "Stands to Check": toCheck,
        "Bike Stands": bikestands,
        "Bikehoops": bikehoops,
        "Bike Maintenance": bikemaintenance,
        "Cycleways": cycleways
      };

      L.control.layers(baseLayers, overlayMaps).addTo(map);
      cyclosm.addTo(map);
    
      function onLocationFound(e) {
        var radius = e.accuracy / 2;

        L.marker(e.latlng).addTo(map)
          .bindPopup("You are within " + radius + " meters from this point").openPopup();

        L.circle(e.latlng, radius).addTo(map);
      }

      function onLocationError(e) {
        alert(e.message);
      }

      map.on('locationfound', onLocationFound);
      map.on('locationerror', onLocationError);

      map.locate({setView: true, maxZoom: 16});

    </script>
  </body>
